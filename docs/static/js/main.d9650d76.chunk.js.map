{"version":3,"sources":["App.module.scss","audios.js","reducer.js","App.js","index.js"],"names":["module","exports","audios","Audio","initialState","playRow","track","Array","fill","map","item","MAP","onLengthChange","state","action","length","payload","index","onCeilClick","rowIndex","ceilIndex","onPlayNext","realPlayRow","forEach","audio","pause","currentTime","findIndex","play","reducer","type","App","useReducer","dispatch","useState","playing","setPlaying","temp","setTemp","onTempChangeHandler","useCallback","event","value","target","Number","isNaN","Math","round","onLengthChangeHandler","onCeilClickHandler","getAttribute","onPlayClick","onStopClick","activeRowIndex","useMemo","useEffect","intervalId","setInterval","clearInterval","className","cn","root","table","header","anotation","row","active","key","data-row-index","data-ceil-index","ceil","onClick","input","onChange","button","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.d9650d76.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"App_root__2CSG3\",\"input\":\"App_input__13lVr\",\"button\":\"App_button__z3Rot\",\"table\":\"App_table__1ESJA\",\"header\":\"App_header__2L3DO\",\"anotation\":\"App_anotation__1h_Ai\",\"row\":\"App_row__3uKGE\",\"active\":\"App_active__2jQ78\",\"ceil\":\"App_ceil__K-eWH\"};","export const audios = [new Audio('mp3/b.wav.mp3'), new Audio('mp3/t.wav.mp3'), new Audio('mp3/s.wav.mp3')]\n","import { audios } from './audios'\n\nexport const initialState = {\n  playRow: 0,\n  track: Array(4)\n    .fill(null)\n    .map((item) => Array(3).fill(false)),\n}\n\nconst onLengthChange = (state, action) => {\n  const { length } = action.payload\n\n  return {\n    ...state,\n    track: Array(length)\n      .fill(null)\n      .map((item, index) => {\n        return state.track[index] || Array(3).fill(false)\n      }),\n  }\n}\n\nconst onCeilClick = (state, action) => {\n  const { rowIndex, ceilIndex } = action.payload\n\n  return {\n    ...state,\n    track: state.track.map((item, index) => {\n      return rowIndex !== index\n        ? item\n        : item.map((item, index) => {\n            return index !== ceilIndex ? false : !item\n          })\n    }),\n  }\n}\n\nconst onPlayNext = (state, action) => {\n  const { playRow, track } = state\n\n  if (!track.length) return { ...state, playRow: 0 }\n\n  const realPlayRow = track[playRow] ? playRow : 0\n\n  audios.forEach((audio) => {\n    audio.pause()\n    audio.currentTime = 0\n  })\n\n  const ceilIndex = track[realPlayRow].findIndex((item) => item)\n\n  if (ceilIndex > -1) {\n    audios[ceilIndex].play()\n  }\n\n  return {\n    ...state,\n    playRow: track[realPlayRow + 1] ? realPlayRow + 1 : 0,\n  }\n}\n\nconst MAP = {\n  onLengthChange,\n  onCeilClick,\n  onPlayNext,\n}\n\nexport const reducer = (state, action) => {\n  return MAP[action.type](state, action)\n}\n\nexport const onLengthChangeAction = (length) => ({\n  type: 'onLengthChange',\n  payload: {\n    length,\n  },\n})\n\nexport const onCeilClickAction = ({ rowIndex, ceilIndex }) => ({\n  type: 'onCeilClick',\n  payload: {\n    rowIndex,\n    ceilIndex,\n  },\n})\n\nexport const onPlayNextAction = () => ({\n  type: 'onPlayNext',\n  payload: {},\n})\n","import React, { useCallback, useReducer, useState, useEffect, useMemo } from 'react'\nimport { reducer, initialState, onLengthChangeAction, onCeilClickAction } from './reducer'\nimport { onPlayNextAction } from './reducer'\n\nimport cn from './App.module.scss'\n\nconst App = () => {\n  const [state, dispatch] = useReducer(reducer, initialState)\n  const [playing, setPlaying] = useState(false)\n  const [temp, setTemp] = useState(60)\n\n  const onTempChangeHandler = useCallback((event) => {\n    const value = +event.target.value\n    if (Number.isNaN(value) || value < 0) return\n    setTemp(Math.round(value))\n  }, [])\n\n  const onLengthChangeHandler = useCallback((event) => {\n    const value = +event.target.value\n    if (Number.isNaN(value) || value < 0) return\n    dispatch(onLengthChangeAction(Math.round(value)))\n  }, [])\n\n  const onCeilClickHandler = useCallback((event) => {\n    const rowIndex = +event.target.getAttribute('data-row-index')\n    const ceilIndex = +event.target.getAttribute('data-ceil-index')\n    dispatch(onCeilClickAction({ rowIndex, ceilIndex }))\n  }, [])\n\n  const onPlayClick = useCallback(() => {\n    setPlaying(true)\n  }, [])\n\n  const onStopClick = useCallback(() => {\n    setPlaying(false)\n  }, [])\n\n  const activeRowIndex = useMemo(() => {\n    if (!playing) return null\n    return state.playRow === 0 ? state.track.length - 1 : state.playRow - 1\n  }, [playing, state])\n\n  useEffect(() => {\n    if (!playing) return\n    const intervalId = setInterval(() => {\n      dispatch(onPlayNextAction())\n    }, 60000 / temp)\n    return () => clearInterval(intervalId)\n  }, [temp, playing])\n\n  return (\n    <div className={cn.root}>\n      <div>\n        <div className={cn.table}>\n          <div className={cn.header}>\n            <div className={cn.anotation}></div>\n            <div className={cn.anotation}>B</div>\n            <div className={cn.anotation}>t</div>\n            <div className={cn.anotation}>S</div>\n          </div>\n          {state.track.map((row, rowIndex) => (\n            <div className={`${cn.row} ${rowIndex === activeRowIndex ? cn.active : ''}`} key={rowIndex}>\n              <div className={cn.anotation}>{rowIndex + 1}</div>\n              {row.map((item, ceilIndex) => (\n                <div\n                  data-row-index={rowIndex}\n                  data-ceil-index={ceilIndex}\n                  key={ceilIndex}\n                  className={`${item ? cn.active : ''} ${cn.ceil}`}\n                  onClick={onCeilClickHandler}\n                ></div>\n              ))}\n            </div>\n          ))}\n        </div>\n      </div>\n      <div>\n        <div className={cn.input}>\n          <div>Размер</div>\n          <div>\n            <input type=\"text\" value={`${state.track.length}`} onChange={onLengthChangeHandler} />\n          </div>\n        </div>\n        <div className={cn.input}>\n          <div>Темп</div>\n          <div>\n            <input type=\"text\" value={`${temp}`} onChange={onTempChangeHandler} />\n          </div>\n        </div>\n        <div className={cn.button}>\n          <button onClick={onPlayClick}>Play</button>\n          <button onClick={onStopClick}>Pause</button>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default App\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\nfunction unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n\nunregister();\n"],"sourceRoot":""}